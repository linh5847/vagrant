lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone --utc Europe/London
# root password PassW0rd123456
rootpw --iscrypted $6$dUkKL9dpyutKonVS$.nPY6EDjegxbIhcp30vxHD1EqQwG06c2f1Pe0xpV9ozShHQzv6SQxUv6Hd7C6DR6QvBZivWe0FiBZxBWoG3r5/
user arda --fullname "ubuntu" --password PassW0rd1234
#Initial user
user --disabled
#Reboot after installation
reboot

#Use text mode install
text
#Install OS instead of upgrade
install
#Use Web installation
url --url http://192.168.56.55/ubuntu/2204
#network --device=eth0 --bootproto=dhcp --nameserver=8.8.8.8 --noipv6
network --bootproto=dhcp --device=eth0 --activate --onboot=on
network  --bootproto=dhcp --device=eth1 --onboot=off --ipv6=ignore --activate
network --hostname=ubuntu2204.localdomain
#System bootloader configuration
#bootloader --location=mbr --append="pcie_aspm=off"
bootloader --location=mbr
#Clear the Master Boot Record
zerombr yes

#Partition clearing information
clearpart --all --initlabel

#Disk partitioning information
part /boot --fstype="xfs" --ondisk=sda --size=1024
part /boot/efi --fstype="vfat" --ondisk=sda --size=512
part pv.278 --fstype="lvmpv" --ondisk=sda --size=30720
volgroup cs --pesize=4096 pv.278
logvol / --fstype="xfs" --grow --size=1024 --name=root --vgname=cs
logvol swap --fstype="swap" --size=5120 --name=swap --vgname=cs
#System authorization infomation
auth  --useshadow  --enablemd5
#Network information


#network --device=eth0 --bootproto=static --ip={{host_ip}} --netmask=255.255.255.0 --gateway=192.168.1.2 --nameserver=192.168.1.2 --hostname={{host_name}} --noipv6


#Firewall configuration
firewall --disabled
#Do not configure the X Window System
skipx

%packages
openssh-server
openssh-client

ethtool
#default-jre
vim
w3m
net-tools
tar
zip
unzip
wget
curl
%post


#rename
#echo {{host_name}}>/etc/hostname
#sed -i 's/kickseed/{{host_name}}/g' /etc/hosts


ntpdate 10.0.0.1
hwclock -w

sed -i "s/PermitRootLogin\ without-password/PermitRootLogin\ yes/g" /etc/ssh/sshd_config
echo "vm.swappiness=0" >>/etc/sysctl.conf

newnameserver="nameserver 8.8.8.8"
echo $newnameserver > /etc/resolvconf/resolv.conf.d/base
resolvconf -u

%end